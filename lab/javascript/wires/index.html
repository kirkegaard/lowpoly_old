<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Lowpoly.dk - Christian Kirkegaard</title>

    <style type="text/css" media="screen">
        html, body {
            height: 100%;
        }
        body {
            margin: 0;
            overflow:hidden;
            background-color: #fff;
              -webkit-box-align: center;
              -webkit-box-pack: center;
              -webkit-transition: 0.25s opacity;
            background: -webkit-radial-gradient(rgba(255, 255, 255, 0),
                                                rgba(160, 160, 160, 0.2) 50%,
                                                rgba(0, 0, 0, 0.4));
            background:    -moz-radial-gradient(rgba(255, 255, 255, 0),
                                                rgba(160, 160, 160, 0.2) 50%,
                                                rgba(0, 0, 0, 0.4));
            background:     -ms-radial-gradient(rgba(255, 255, 255, 0),
                                                rgba(160, 160, 160, 0.2) 50%,
                                                rgba(0, 0, 0, 0.4));
            background:      -o-radial-gradient(rgba(255, 255, 255, 0),
                                                rgba(160, 160, 160, 0.2) 50%,
                                                rgba(0, 0, 0, 0.4));
        }

    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        (function() {
            var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
                window.requestAnimationFrame = requestAnimationFrame;

            var SCREEN_WIDTH  = window.innerWidth
              , SCREEN_HEIGHT = window.innerHeight
              , HALF_Y        = SCREEN_HEIGHT / 2
              , HALF_X        = SCREEN_WIDTH / 2
              , canvas        = document.getElementById('canvas')
              , context       = canvas.getContext('2d')
              , NOW           = new Date()
              , PPL           = 12
              , LINES         = 6
              , POINTS        = []
              , POINT_WIDTH   = SCREEN_WIDTH / (PPL + 1)
              , MEDIAN        = HALF_Y / 2;

            init();
            render();
            // animate();

            window.onresize = function() {
                init();
                render();
            }

            function init() {
                SCREEN_WIDTH  = window.innerWidth;
                SCREEN_HEIGHT = window.innerHeight;
                canvas.height = SCREEN_HEIGHT;
                canvas.width  = SCREEN_WIDTH;
                HALF_Y        = SCREEN_HEIGHT / 2;
                HALF_X        = SCREEN_WIDTH / 2;
                POINT_WIDTH   = SCREEN_WIDTH / (PPL + 1);
                MEDIAN        = HALF_Y / 2;

                for(var l = 0; l < LINES; l++) {
                    POINTS[l] = [];
                    for(var p = 0; p < PPL; p++) {
                        POINTS[l][p] = Math.floor(rnd(
                            HALF_Y - MEDIAN,
                            HALF_Y + MEDIAN
                        ));
                    }
                }
            }

            // function animate() {
            //     requestAnimationFrame(animate);
            //     render();
            // }

            function render() {
                var millis = new Date() - NOW;
                context.fillStyle = 'rgba(255, 255, 255, 0)';
                context.fillRect (0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);

                for(var x = 0; x < POINTS.length; x++) {
                    context.lineWidth = 1;
                    context.strokeStyle = 'rgba(0, 0, 0, 0.2)';
                    context.beginPath();
                    context.moveTo(0, rnd(HALF_Y - (MEDIAN/4), HALF_Y + (MEDIAN/4)));

                    for(var y = 0; y < POINTS[x].length; y++) {
                        var py = POINTS[x][y];
                        var px = POINT_WIDTH * (y + 1);

                        var cy = (py + POINTS[x][y + 1]) / 2;
                        var cx = (px + (POINT_WIDTH * (y + 2))) / 2;

                        context.quadraticCurveTo(px, py, cx, cy);
                    }

                    context.quadraticCurveTo(
                        px, py,
                        SCREEN_WIDTH,
                        rnd(HALF_Y - (MEDIAN/4), HALF_Y + (MEDIAN/4))
                    );
                    context.stroke();
                }

                for(var x = 0; x < POINTS.length; x++) {
                    for(var y = 0; y < POINTS[x].length; y++) {
                        var py = POINTS[x][y];
                        var px = POINT_WIDTH * (y + 1);

                        var cy = (py + POINTS[x][y + 1]) / 2;
                        var cx = (px + (POINT_WIDTH * (y + 2))) / 2;

                        context.fillStyle = 'rgba(0, 0, 0, 0.3)';
                        context.beginPath();
                        context.arc(cx, cy, rnd(2, 10), 0, Math.PI*2, true);
                        context.closePath();
                        context.fill();
                    }
                }
            }

            function rnd(min, max) {
                return Math.random() * (max - min) + min;
            }

        })();
    </script>
</body>
</html>
